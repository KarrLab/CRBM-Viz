#!/usr/bin/env python3

from src.s3 import delete_temporary_combine_archives_in_s3_bucket, TEMP_COMBINE_ARCHIVE_MAX_AGE
import argparse


if __name__ == '__main__':
    parser = argparse.ArgumentParser(
        description='Delete the temporary COMBINE archives generated by the dispatch app from the S3 bucket')
    parser.add_argument('--min-age', type=int,
                        help='Minimum age in days required for deletion. Default: {} days'.format(TEMP_COMBINE_ARCHIVE_MAX_AGE),
                        default=TEMP_COMBINE_ARCHIVE_MAX_AGE)
    args = parser.parse_args()
    delete_temporary_combine_archives_in_s3_bucket(min_age=args.min_age)
